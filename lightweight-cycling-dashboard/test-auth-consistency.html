<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Authentication Consistency</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #1a1a1a; color: white; }
        .test-result { margin: 10px 0; padding: 10px; border-radius: 5px; }
        .pass { background-color: #d4edda; color: #155724; }
        .fail { background-color: #f8d7da; color: #721c24; }
        .info { background-color: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <h1>Authentication Consistency Test</h1>
    <p>Verifying that both leaderboard and spaceship API calls use the same Basic auth token.</p>
    <div id="test-results"></div>
    
    <script src="scripts/data-fetcher.js"></script>
    <script>
        function addResult(test, passed, details = '') {
            const results = document.getElementById('test-results');
            const div = document.createElement('div');
            div.className = `test-result ${passed ? 'pass' : 'fail'}`;
            div.innerHTML = `<strong>${test}:</strong> ${passed ? '‚úÖ PASS' : '‚ùå FAIL'} ${details}`;
            results.appendChild(div);
        }
        
        function addInfo(message) {
            const results = document.getElementById('test-results');
            const div = document.createElement('div');
            div.className = 'test-result info';
            div.innerHTML = `<strong>‚ÑπÔ∏è Info:</strong> ${message}`;
            results.appendChild(div);
        }
        
        // Test authentication consistency
        addInfo('Both API endpoints should use the same Basic auth token');
        
        const expectedAuthHeader = 'Basic NjkwMjdhZjZlMTc5ZDQ2ZmNlMjgzZTdlOjY5MDI4MjI0ZTE3OWQ0NmZjZTI4NDI2ZA==';
        
        addInfo(`Expected Authorization header: ${expectedAuthHeader}`);
        
        // Test API endpoints
        const endpoints = [
            {
                name: 'Leaderboard API',
                method: 'POST',
                url: 'https://service2.funifier.com/v3/leaderboard/FbdmEIT/leader/aggregate',
                body: '{"period": "", "live": true}',
                description: 'Fetches leaderboard data'
            },
            {
                name: 'Spaceship Database API',
                method: 'GET', 
                url: 'https://service2.funifier.com/v3/database/espacial__c',
                body: 'N/A',
                description: 'Fetches spaceship assets'
            }
        ];
        
        endpoints.forEach(endpoint => {
            addInfo(`${endpoint.name}: ${endpoint.method} ${endpoint.url}`);
            addInfo(`Body: ${endpoint.body}`);
            addInfo(`Purpose: ${endpoint.description}`);
        });
        
        // Verify DataFetcher class has consistent auth
        try {
            const dataFetcher = new DataFetcher();
            addResult('DataFetcher instantiation', true, 'Class created successfully');
            
            // Both methods should be available
            const hasLeaderboardMethod = typeof dataFetcher.fetchLeaderboard === 'function';
            const hasSpaceshipMethod = typeof dataFetcher.fetchSpaceshipAssets === 'function';
            
            addResult('Leaderboard method exists', hasLeaderboardMethod);
            addResult('Spaceship assets method exists', hasSpaceshipMethod);
            
            if (hasLeaderboardMethod && hasSpaceshipMethod) {
                addResult('API methods consistency', true, 'Both methods available and should use same auth');
            }
            
        } catch (error) {
            addResult('DataFetcher test', false, error.message);
        }
        
        // Show authentication benefits
        const benefits = document.createElement('div');
        benefits.innerHTML = `
            <div style="margin: 20px 0; padding: 15px; background: rgba(0,255,0,0.1); border-radius: 8px;">
                <h3>‚úÖ Authentication Consistency Benefits:</h3>
                <ul>
                    <li><strong>Security:</strong> Same credentials for all Funifier API calls</li>
                    <li><strong>Maintenance:</strong> Single auth token to manage</li>
                    <li><strong>Reliability:</strong> Consistent access patterns</li>
                    <li><strong>Debugging:</strong> Easier to troubleshoot auth issues</li>
                </ul>
                
                <h3>üîê API Calls Using Same Auth:</h3>
                <ul>
                    <li>Leaderboard data: <code>POST /v3/leaderboard/{id}/leader/aggregate</code></li>
                    <li>Spaceship assets: <code>GET /v3/database/espacial__c</code></li>
                </ul>
            </div>
        `;
        document.body.appendChild(benefits);
    </script>
</body>
</html>